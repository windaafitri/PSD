
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tugas_uts/main';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Proyek Sains Data" href="../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Proyek Sains Data
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ftugas_uts/main.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tugas_uts/main.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><no title></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>##Prediksi Harga Minyak Per-Minggu</p>
<p>Data yang digunakan merupakan data harga penjualan minyak goreng per minggu, dimulai dari tahun 2020-2024
Data diambil dari situs <a class="reference external" href="https://www.bi.go.id/hargapangan/TabelHarga/PasarTradisionalDaerah">https://www.bi.go.id/hargapangan/TabelHarga/PasarTradisionalDaerah</a></p>
<p>#Read Data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="c1">#Mengambil dan menampilkan data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/PSD/DataMinyak/OilPrice/harga_minyak.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;plotly&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pastikan kolom &#39;Date&#39; dalam format datetime dengan dayfirst=True</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tanggal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Tanggal&#39;</span><span class="p">],</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="c1"># Mengatur kolom &#39;Date&#39; sebagai indeks</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Tanggal&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Menghapus spasi dari kolom &#39;Harga&#39;, mengganti &#39;-&#39; dengan NaN, dan mengubahnya menjadi numeric</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Menampilkan 5 baris pertama untuk memastikan</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              Harga
Tanggal            
2020-01-01  15550.0
2020-01-08  15500.0
2020-01-15  15550.0
2020-01-22  15600.0
2020-01-29  15650.0
</pre></div>
</div>
</div>
</div>
<p>#Menjelaskan Data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Tanggal&#39;&gt;
</pre></div>
</div>
<img alt="../_images/b97131e996732b2164938d902da1fe60d3620a4212e1e2884caed31499416f3b.png" src="../_images/b97131e996732b2164938d902da1fe60d3620a4212e1e2884caed31499416f3b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ukuran data &#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 248 entries, 2020-01-01 to 2024-09-25
Data columns (total 1 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   Harga   248 non-null    float64
dtypes: float64(1)
memory usage: 3.9 KB
Ukuran data  (248, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Harga</th>
      <td>float64</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> object</label></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mencari Missing Value</span>
<span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Harga</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Deskripsi Statistik</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c79aef35-40fd-4a8a-85e2-cec02f41f7ef" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Harga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>248.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>20019.153226</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3397.558973</td>
    </tr>
    <tr>
      <th>min</th>
      <td>15500.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>16350.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>21350.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>22700.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>26450.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c79aef35-40fd-4a8a-85e2-cec02f41f7ef')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c79aef35-40fd-4a8a-85e2-cec02f41f7ef button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c79aef35-40fd-4a8a-85e2-cec02f41f7ef');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d16a096f-3a0b-4f33-bacf-03384fc12088">
  <button class="colab-df-quickchart" onclick="quickchart('df-d16a096f-3a0b-4f33-bacf-03384fc12088')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d16a096f-3a0b-4f33-bacf-03384fc12088 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<p>#Sliding Windows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_lag_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">num_lags</span><span class="p">):</span>

    <span class="c1"># Buat fitur lag untuk jumlah lag yang diinginkan</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

    <span class="c1"># Hapus baris yang memiliki nilai NaN setelah pembuatan lag</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Mengatur ulang kolom sehingga kolom asli berada di posisi terakhir</span>
    <span class="n">lag_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lags</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">column_name</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Contoh penggunaan</span>
<span class="n">num_lags</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Tentukan berapa banyak lag yang diinginkan</span>
<span class="n">df_lagged</span> <span class="o">=</span> <span class="n">create_lag_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Harga&#39;</span><span class="p">,</span> <span class="n">num_lags</span><span class="p">)</span>

<span class="c1"># Menampilkan 5 baris pertama untuk memastikan fitur lag telah ditambahkan</span>
<span class="n">df_lagged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-082504fb-97bb-4d80-af52-86b0c683002c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Harga-4</th>
      <th>Harga-3</th>
      <th>Harga-2</th>
      <th>Harga-1</th>
      <th>Harga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>15550.0</td>
      <td>15500.0</td>
      <td>15550.0</td>
      <td>15600.0</td>
      <td>15650.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>15500.0</td>
      <td>15550.0</td>
      <td>15600.0</td>
      <td>15650.0</td>
      <td>15750.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>15550.0</td>
      <td>15600.0</td>
      <td>15650.0</td>
      <td>15750.0</td>
      <td>15800.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>15600.0</td>
      <td>15650.0</td>
      <td>15750.0</td>
      <td>15800.0</td>
      <td>15850.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>15650.0</td>
      <td>15750.0</td>
      <td>15800.0</td>
      <td>15850.0</td>
      <td>16050.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-082504fb-97bb-4d80-af52-86b0c683002c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-082504fb-97bb-4d80-af52-86b0c683002c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-082504fb-97bb-4d80-af52-86b0c683002c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c55a623c-e04d-4bae-b7b3-c46e62d4bb13">
  <button class="colab-df-quickchart" onclick="quickchart('df-c55a623c-e04d-4bae-b7b3-c46e62d4bb13')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c55a623c-e04d-4bae-b7b3-c46e62d4bb13 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<p>#Normalisasi Data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Fungsi untuk membuat fitur lag secara dinamis</span>
<span class="k">def</span> <span class="nf">create_lag_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">num_lags</span><span class="p">):</span>

    <span class="c1"># Buat fitur lag untuk jumlah lag yang diinginkan</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

    <span class="c1"># Hapus baris yang memiliki nilai NaN setelah pembuatan lag</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Mengatur ulang kolom sehingga kolom asli berada di posisi terakhir</span>
    <span class="n">lag_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_lags</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">column_name</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Tentukan jumlah lag</span>
<span class="n">num_lags</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Membuat fitur lag dinamis</span>
<span class="n">df_lagged</span> <span class="o">=</span> <span class="n">create_lag_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Harga&#39;</span><span class="p">,</span> <span class="n">num_lags</span><span class="p">)</span>

<span class="c1"># Inisialisasi scaler untuk fitur (input) dan target (output)</span>
<span class="n">scaler_features</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler_target</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="c1"># Normalisasi fitur (Harga-1, Harga-2, ..., Harga-n)</span>
<span class="n">df_features_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler_features</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_lagged</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                      <span class="n">columns</span><span class="o">=</span><span class="n">df_lagged</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                      <span class="n">index</span><span class="o">=</span><span class="n">df_lagged</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Normalisasi target (Harga)</span>
<span class="n">df_target_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler_target</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_lagged</span><span class="p">[[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]]),</span>
                                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">],</span>
                                    <span class="n">index</span><span class="o">=</span><span class="n">df_lagged</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Gabungkan kembali dataframe yang sudah dinormalisasi</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_features_normalized</span><span class="p">,</span> <span class="n">df_target_normalized</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Tampilkan 5 baris pertama dari dataframe yang sudah dinormalisasi</span>
<span class="n">df_normalized</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c004f22d-9d05-4de5-87cd-1c7393837517" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Harga-4</th>
      <th>Harga-3</th>
      <th>Harga-2</th>
      <th>Harga-1</th>
      <th>Harga</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.004695</td>
      <td>0.023474</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.009259</td>
      <td>0.004673</td>
      <td>0.004695</td>
      <td>0.023474</td>
      <td>0.018779</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.013889</td>
      <td>0.009346</td>
      <td>0.023474</td>
      <td>0.018779</td>
      <td>0.023474</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.018519</td>
      <td>0.028037</td>
      <td>0.018779</td>
      <td>0.023474</td>
      <td>0.028169</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.037037</td>
      <td>0.023364</td>
      <td>0.023474</td>
      <td>0.028169</td>
      <td>0.032864</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c004f22d-9d05-4de5-87cd-1c7393837517')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c004f22d-9d05-4de5-87cd-1c7393837517 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c004f22d-9d05-4de5-87cd-1c7393837517');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5915835b-1cd2-4d58-b6c6-cc8b1cc05bc0">
  <button class="colab-df-quickchart" onclick="quickchart('df-5915835b-1cd2-4d58-b6c6-cc8b1cc05bc0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5915835b-1cd2-4d58-b6c6-cc8b1cc05bc0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definisikan jumlah lag dinamis</span>
<span class="n">num_lags</span> <span class="o">=</span> <span class="mi">4</span> 

<span class="c1"># Membuat kolom lag secara dinamis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">df_normalized</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c1"># Menghapus baris yang memiliki nilai NaN akibat lag</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Mengatur fitur (X) dan target (y)</span>
<span class="n">lag_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span>

<span class="c1"># Membagi data menjadi training dan testing (80% training, 20% testing)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===== Data Train =====&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===== Data Testing =====&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Mengambil nilai tanggal dari indeks X_train dan X_test</span>
<span class="n">dates_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span>
<span class="n">dates_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Plot data training dan testing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">num_lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Training&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">num_lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Testing&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Menambahkan judul, label, dan legenda</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pembagian Data Training dan Testing Berdasarkan Harga dengan </span><span class="si">{</span><span class="n">num_lags</span><span class="si">}</span><span class="s1"> Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tanggal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===== Data Train =====
      Harga-1   Harga-2   Harga-3   Harga-4
12   0.028169  0.023474  0.018779  0.023474
13   0.032864  0.028169  0.023474  0.018779
14   0.023474  0.032864  0.028169  0.023474
15   0.028169  0.023474  0.032864  0.028169
16   0.028169  0.028169  0.023474  0.032864
..        ...       ...       ...       ...
195  0.624413  0.619718  0.615023  0.624413
196  0.619718  0.624413  0.619718  0.615023
197  0.610329  0.619718  0.624413  0.619718
198  0.600939  0.610329  0.619718  0.624413
199  0.591549  0.600939  0.610329  0.619718

[188 rows x 4 columns]
===== Data Testing =====
      Harga-1   Harga-2   Harga-3   Harga-4
200  0.596244  0.591549  0.600939  0.610329
201  0.596244  0.596244  0.591549  0.600939
202  0.596244  0.596244  0.596244  0.591549
203  0.596244  0.596244  0.596244  0.596244
204  0.600939  0.596244  0.596244  0.596244
205  0.553991  0.600939  0.596244  0.596244
206  0.544601  0.553991  0.600939  0.596244
207  0.539906  0.544601  0.553991  0.600939
208  0.582160  0.539906  0.544601  0.553991
209  0.568075  0.582160  0.539906  0.544601
210  0.596244  0.568075  0.582160  0.539906
211  0.577465  0.596244  0.568075  0.582160
212  0.605634  0.577465  0.596244  0.568075
213  0.591549  0.605634  0.577465  0.596244
214  0.600939  0.591549  0.605634  0.577465
215  0.582160  0.600939  0.591549  0.605634
216  0.582160  0.582160  0.600939  0.591549
217  0.596244  0.582160  0.582160  0.600939
218  0.610329  0.596244  0.582160  0.582160
219  0.624413  0.610329  0.596244  0.582160
220  0.577465  0.624413  0.610329  0.596244
221  0.577465  0.577465  0.624413  0.610329
222  0.563380  0.577465  0.577465  0.624413
223  0.563380  0.563380  0.577465  0.577465
224  0.558685  0.563380  0.563380  0.577465
225  0.558685  0.558685  0.563380  0.563380
226  0.553991  0.558685  0.558685  0.563380
227  0.558685  0.553991  0.558685  0.558685
228  0.558685  0.558685  0.553991  0.558685
229  0.553991  0.558685  0.558685  0.553991
230  0.539906  0.553991  0.558685  0.558685
231  0.549296  0.539906  0.553991  0.558685
232  0.535211  0.549296  0.539906  0.553991
233  0.568075  0.535211  0.549296  0.539906
234  0.539906  0.568075  0.535211  0.549296
235  0.553991  0.539906  0.568075  0.535211
236  0.544601  0.553991  0.539906  0.568075
237  0.530516  0.544601  0.553991  0.539906
238  0.539906  0.530516  0.544601  0.553991
239  0.530516  0.539906  0.530516  0.544601
240  0.492958  0.530516  0.539906  0.530516
241  0.521127  0.492958  0.530516  0.539906
242  0.521127  0.521127  0.492958  0.530516
243  0.530516  0.521127  0.521127  0.492958
244  0.497653  0.530516  0.521127  0.521127
245  0.521127  0.497653  0.530516  0.521127
246  0.516432  0.521127  0.497653  0.530516
247  0.516432  0.516432  0.521127  0.497653
</pre></div>
</div>
<img alt="../_images/4d30ff0c5715d8b3cd12994ab98191c143cc2edee3aea268d5ef74fea6e073b5.png" src="../_images/4d30ff0c5715d8b3cd12994ab98191c143cc2edee3aea268d5ef74fea6e073b5.png" />
</div>
</div>
<p>##JST (Jaringan Syaraf Tiruan atau ANN)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Membuat fitur lag dinamis</span>
<span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lags</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

<span class="c1"># Menghapus baris dengan NaN setelah membuat lag</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Memilih kolom lag yang ingin digunakan</span>
<span class="n">lag_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lags</span><span class="p">]</span>
<span class="n">df_lag</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">lag_columns</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>normalisasi fitur lag</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalisasi fitur lag dan target</span>
<span class="n">df_features_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler_features</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_lag</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]),</span>
                                      <span class="n">columns</span><span class="o">=</span><span class="n">lag_columns</span><span class="p">,</span>
                                      <span class="n">index</span><span class="o">=</span><span class="n">df_lag</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">df_target_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler_target</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_lag</span><span class="p">[[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]]),</span>
                                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">],</span>
                                    <span class="n">index</span><span class="o">=</span><span class="n">df_lag</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Gabungkan kembali fitur lag dan target yang sudah dinormalisasi</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_features_normalized</span><span class="p">,</span> <span class="n">df_target_normalized</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>mengatur data uji dan data latih</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mengatur fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span>

<span class="c1"># Membagi data menjadi training dan testing (80% training, 20% testing)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Membaca data dan mengonversi kolom &#39;Harga&#39; ke format numerik</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/PSD/DataMinyak/OilPrice/harga_minyak.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Menghapus koma dan mengonversi ke float</span>

<span class="c1"># Fungsi untuk membuat fitur lag dinamis</span>
<span class="k">def</span> <span class="nf">create_lagged_features</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">lag_list</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lag_list</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_column</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Menghapus baris dengan NaN setelah membuat lag</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Menentukan lag yang diinginkan </span>
<span class="n">lag_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">df_lag</span> <span class="o">=</span> <span class="n">create_lagged_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Harga&#39;</span><span class="p">,</span> <span class="n">lag_list</span><span class="p">)</span>

<span class="c1"># Normalisasi fitur lag dan target</span>
<span class="n">scaler_features</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler_target</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="c1"># Normalisasi hanya kolom yang dipilih (Harga-4)</span>
<span class="n">lag_column_name</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">lag_list</span><span class="p">]</span>  <span class="c1"># Kolom yang relevan</span>
<span class="n">df_features_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler_features</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_lag</span><span class="p">[</span><span class="n">lag_column_name</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">lag_column_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df_lag</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df_target_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler_target</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_lag</span><span class="p">[[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">df_lag</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Menggabungkan fitur lag dan target yang sudah dinormalisasi</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_features_normalized</span><span class="p">,</span> <span class="n">df_target_normalized</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Mengatur fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">lag_column_name</span><span class="p">]</span>  
<span class="n">y</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span>

<span class="c1"># Membagi data menjadi training dan testing (80% training, 20% testing)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Membangun model Neural Network</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>  <span class="c1"># Input layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>  <span class="c1"># Hidden layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">))</span>  <span class="c1"># Output layer</span>

<span class="c1"># Kompilasi model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

<span class="c1"># Melatih model</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="c1"># Evaluasi model pada data uji</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loss pada data uji (MSE): </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Membuat prediksi menggunakan data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Mengembalikan hasil prediksi ke skala asli</span>
<span class="n">y_pred_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y_test_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Metrik evaluasi</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_original</span><span class="p">,</span> <span class="n">y_pred_original</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Error (MAE): </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_original</span><span class="p">,</span> <span class="n">y_pred_original</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error (MSE): </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Root Mean Squared Error (RMSE): </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_original</span><span class="p">,</span> <span class="n">y_pred_original</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R-squared (R): </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/50
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">2s</span> 48ms/step - loss: 0.0676 - val_loss: 0.0144
Epoch 2/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0271 - val_loss: 0.0024
Epoch 3/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0190 - val_loss: 0.0054
Epoch 4/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0187 - val_loss: 9.3774e-04
Epoch 5/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0132 - val_loss: 0.0013
Epoch 6/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 9ms/step - loss: 0.0127 - val_loss: 0.0014
Epoch 7/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0163 - val_loss: 5.3550e-04
Epoch 8/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0142 - val_loss: 5.1356e-04
Epoch 9/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0117 - val_loss: 5.5055e-04
Epoch 10/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0140 - val_loss: 5.3499e-04
Epoch 11/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0121 - val_loss: 5.1735e-04
Epoch 12/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0134 - val_loss: 5.8539e-04
Epoch 13/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0089 - val_loss: 5.9135e-04
Epoch 14/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0126 - val_loss: 5.2398e-04
Epoch 15/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0119 - val_loss: 5.1814e-04
Epoch 16/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0115 - val_loss: 5.2384e-04
Epoch 17/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0118 - val_loss: 5.6004e-04
Epoch 18/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 8ms/step - loss: 0.0221 - val_loss: 6.3847e-04
Epoch 19/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 9ms/step - loss: 0.0078 - val_loss: 7.4122e-04
Epoch 20/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0215 - val_loss: 5.4254e-04
Epoch 21/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0113 - val_loss: 5.2023e-04
Epoch 22/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0168 - val_loss: 0.0013
Epoch 23/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0158 - val_loss: 5.1257e-04
Epoch 24/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 9ms/step - loss: 0.0119 - val_loss: 7.8344e-04
Epoch 25/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0142 - val_loss: 5.2133e-04
Epoch 26/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0120 - val_loss: 6.0515e-04
Epoch 27/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0185 - val_loss: 5.7806e-04
Epoch 28/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 9ms/step - loss: 0.0220 - val_loss: 5.2715e-04
Epoch 29/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0188 - val_loss: 6.7845e-04
Epoch 30/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0107 - val_loss: 5.1974e-04
Epoch 31/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0128 - val_loss: 5.4317e-04
Epoch 32/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0120 - val_loss: 5.2951e-04
Epoch 33/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0124 - val_loss: 7.0570e-04
Epoch 34/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0121 - val_loss: 0.0011
Epoch 35/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0187 - val_loss: 5.5287e-04
Epoch 36/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0189 - val_loss: 0.0015
Epoch 37/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0134 - val_loss: 5.3328e-04
Epoch 38/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0102 - val_loss: 5.5761e-04
Epoch 39/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0138 - val_loss: 7.2651e-04
Epoch 40/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0156 - val_loss: 5.2465e-04
Epoch 41/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0130 - val_loss: 5.1976e-04
Epoch 42/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0125 - val_loss: 5.2171e-04
Epoch 43/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0140 - val_loss: 5.8175e-04
Epoch 44/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0132 - val_loss: 6.1580e-04
Epoch 45/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0159 - val_loss: 5.1843e-04
Epoch 46/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0215 - val_loss: 7.4256e-04
Epoch 47/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0124 - val_loss: 5.1622e-04
Epoch 48/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0197 - val_loss: 5.1326e-04
Epoch 49/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0204 - val_loss: 5.6978e-04
Epoch 50/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 0.0095 - val_loss: 5.1904e-04
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 5.5960e-04 
Loss pada data uji (MSE): 0.0005190380034036934
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 47ms/step
Mean Absolute Error (MAE): 182.24250637755117
Mean Squared Error (MSE): 60540.70736133808
Root Mean Squared Error (RMSE): 246.05021308939783
R-squared (R): 0.4737210775721492
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

<span class="c1"># Membuat model Neural Network</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Input layer (sesuai dengan jumlah fitur) dan hidden layer pertama</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>

<span class="c1"># Hidden layer kedua</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>

<span class="c1"># Output layer (1 neuron untuk prediksi nilai Harga)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">))</span>

<span class="c1"># Kompilasi model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

<span class="c1"># Melatih model</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="c1"># Evaluasi model pada data uji</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loss pada data uji (MSE): </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Membuat prediksi menggunakan data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Mengembalikan hasil prediksi ke skala asli (dari skala normalisasi)</span>
<span class="n">y_pred_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y_test_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="c1"># Plot hasil prediksi vs nilai sebenarnya dengan sumbu x sebagai tanggal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_original</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Harga&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_original</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediksi Neural Network&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prediksi Harga Menggunakan Neural Network&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># Rotasi label x-axis agar lebih mudah dibaca</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plot error (loss) selama training dan validasi tiap epoch</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and Validation Loss per Epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Loss (Mean Squared Error)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/50
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">3s</span> 53ms/step - loss: 0.2412 - val_loss: 0.2126
Epoch 2/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.1572 - val_loss: 0.1282
Epoch 3/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 23ms/step - loss: 0.1132 - val_loss: 0.0728
Epoch 4/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 18ms/step - loss: 0.0669 - val_loss: 0.0334
Epoch 5/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 17ms/step - loss: 0.0438 - val_loss: 0.0106
Epoch 6/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 20ms/step - loss: 0.0360 - val_loss: 0.0012
Epoch 7/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 15ms/step - loss: 0.0259 - val_loss: 6.7532e-04
Epoch 8/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 20ms/step - loss: 0.0259 - val_loss: 0.0011
Epoch 9/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 24ms/step - loss: 0.0240 - val_loss: 6.0389e-04
Epoch 10/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 20ms/step - loss: 0.0215 - val_loss: 6.3706e-04
Epoch 11/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 35ms/step - loss: 0.0201 - val_loss: 8.8534e-04
Epoch 12/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">1s</span> 26ms/step - loss: 0.0204 - val_loss: 7.4080e-04
Epoch 13/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 32ms/step - loss: 0.0167 - val_loss: 5.1652e-04
Epoch 14/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">1s</span> 11ms/step - loss: 0.0165 - val_loss: 4.9629e-04
Epoch 15/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0114 - val_loss: 5.1477e-04
Epoch 16/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0162 - val_loss: 5.2854e-04
Epoch 17/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0209 - val_loss: 5.6251e-04
Epoch 18/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0123 - val_loss: 5.4160e-04
Epoch 19/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0112 - val_loss: 5.1849e-04
Epoch 20/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0097 - val_loss: 5.3237e-04
Epoch 21/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0127 - val_loss: 5.9233e-04
Epoch 22/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0140 - val_loss: 9.3323e-04
Epoch 23/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0165 - val_loss: 6.1858e-04
Epoch 24/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0185 - val_loss: 5.2285e-04
Epoch 25/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0140 - val_loss: 5.2060e-04
Epoch 26/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0125 - val_loss: 5.1868e-04
Epoch 27/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0171 - val_loss: 5.2006e-04
Epoch 28/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 8ms/step - loss: 0.0106 - val_loss: 5.4513e-04
Epoch 29/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0120 - val_loss: 5.4940e-04
Epoch 30/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0163 - val_loss: 5.4525e-04
Epoch 31/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0113 - val_loss: 5.3648e-04
Epoch 32/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0111 - val_loss: 0.0014
Epoch 33/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0165 - val_loss: 0.0016
Epoch 34/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0174 - val_loss: 5.1765e-04
Epoch 35/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0132 - val_loss: 7.3364e-04
Epoch 36/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0157 - val_loss: 5.4518e-04
Epoch 37/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 8ms/step - loss: 0.0108 - val_loss: 5.3392e-04
Epoch 38/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0104 - val_loss: 8.2371e-04
Epoch 39/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0116 - val_loss: 5.6599e-04
Epoch 40/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0165 - val_loss: 5.2450e-04
Epoch 41/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0099 - val_loss: 7.0799e-04
Epoch 42/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0173 - val_loss: 5.8283e-04
Epoch 43/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0200 - val_loss: 5.1611e-04
Epoch 44/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0112 - val_loss: 5.2116e-04
Epoch 45/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0083 - val_loss: 5.2425e-04
Epoch 46/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0128 - val_loss: 6.2912e-04
Epoch 47/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0129 - val_loss: 5.6374e-04
Epoch 48/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 9ms/step - loss: 0.0206 - val_loss: 5.2579e-04
Epoch 49/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 7ms/step - loss: 0.0153 - val_loss: 7.0982e-04
Epoch 50/50
<span class=" -Color -Color-Bold">7/7</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0135 - val_loss: 5.5928e-04
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 6ms/step - loss: 6.0991e-04 
Loss pada data uji (MSE): 0.0005592823727056384
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 39ms/step
</pre></div>
</div>
<img alt="../_images/fc1fb033f0407b53bc44e554582f1a0d4d0a9ba705219f25d19a24883d8be925.png" src="../_images/fc1fb033f0407b53bc44e554582f1a0d4d0a9ba705219f25d19a24883d8be925.png" />
<img alt="../_images/9dce78fa80a9029cb9c0f7b70c08c27b97c61c71e53426f1933f36190c620630.png" src="../_images/9dce78fa80a9029cb9c0f7b70c08c27b97c61c71e53426f1933f36190c620630.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>

<span class="c1"># Membuat prediksi menggunakan data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Hitung Mean Absolute Error (MAE)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Error (MAE): </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Hitung Mean Squared Error (MSE)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error (MSE): </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Menghitung RMSE</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Root Mean Squared Error (RMSE): </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Hitung R-squared (R)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R-squared (R): </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Hitung Mean Absolute Percentage Error (MAPE)</span>
<span class="c1"># mape = np.mean(np.abs((y_test - y_pred) / y_test)) * 100</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Percentage Error (MAPE): </span><span class="si">{</span><span class="n">mape</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 5ms/step 
Mean Absolute Error (MAE): 0.018295435430601713
Mean Squared Error (MSE): 0.0005592822745049739
Root Mean Squared Error (RMSE): 0.023649149551410384
R-squared (R): 0.43291644648688565
Mean Absolute Percentage Error (MAPE): 0.03200665647291713%
</pre></div>
</div>
</div>
</div>
<p>##JST + Ensemble Bagging</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">scikeras</span><span class="p">[</span><span class="n">tensorflow</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting scikeras[tensorflow]
  Downloading scikeras-0.13.0-py3-none-any.whl.metadata (3.1 kB)
Requirement already satisfied: keras&gt;=3.2.0 in /usr/local/lib/python3.10/dist-packages (from scikeras[tensorflow]) (3.4.1)
Requirement already satisfied: scikit-learn&gt;=1.4.2 in /usr/local/lib/python3.10/dist-packages (from scikeras[tensorflow]) (1.5.2)
Requirement already satisfied: tensorflow&gt;=2.16.1 in /usr/local/lib/python3.10/dist-packages (from scikeras[tensorflow]) (2.17.0)
Requirement already satisfied: absl-py in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (1.4.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (1.26.4)
Requirement already satisfied: rich in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (13.9.3)
Requirement already satisfied: namex in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (0.0.8)
Requirement already satisfied: h5py in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (3.12.1)
Requirement already satisfied: optree in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (0.13.0)
Requirement already satisfied: ml-dtypes in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (0.4.1)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (24.1)
Requirement already satisfied: scipy&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=1.4.2-&gt;scikeras[tensorflow]) (1.13.1)
Requirement already satisfied: joblib&gt;=1.2.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=1.4.2-&gt;scikeras[tensorflow]) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=1.4.2-&gt;scikeras[tensorflow]) (3.5.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=24.3.25 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (24.3.25)
Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (0.6.0)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (0.2.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (18.1.1)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.4.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.20.3)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (2.32.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (75.1.0)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (1.16.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (2.5.0)
Requirement already satisfied: typing-extensions&gt;=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (4.12.2)
Requirement already satisfied: wrapt&gt;=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (1.16.0)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (1.64.1)
Requirement already satisfied: tensorboard&lt;2.18,&gt;=2.17 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (2.17.0)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (0.37.1)
Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (0.44.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.4.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (2024.8.30)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.18,&gt;=2.17-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.7)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.18,&gt;=2.17-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.18,&gt;=2.17-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.0.6)
Requirement already satisfied: markdown-it-py&gt;=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich-&gt;keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (3.0.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich-&gt;keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (2.18.0)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py&gt;=2.2.0-&gt;rich-&gt;keras&gt;=3.2.0-&gt;scikeras[tensorflow]) (0.1.2)
Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard&lt;2.18,&gt;=2.17-&gt;tensorflow&gt;=2.16.1-&gt;scikeras[tensorflow]) (3.0.2)
Downloading scikeras-0.13.0-py3-none-any.whl (26 kB)
Installing collected packages: scikeras
Successfully installed scikeras-0.13.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scikeras.wrappers</span> <span class="kn">import</span> <span class="n">KerasRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Input</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

<span class="c1"># Definisikan jumlah lag dinamis</span>
<span class="n">num_lags</span> <span class="o">=</span> <span class="mi">4</span>  

<span class="c1"># Membuat kolom lag secara dinamis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">df_normalized</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c1"># Menghapus baris yang memiliki nilai NaN akibat lag</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Mengatur fitur (X) dan target (y)</span>
<span class="n">lag_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span>

<span class="c1"># Membagi data menjadi training dan testing (80% training, 20% testing)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Fungsi untuk membuat model neural network</span>
<span class="k">def</span> <span class="nf">create_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_lags</span><span class="p">,)))</span>  <span class="c1"># Menggunakan num_lags sebagai input</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Membuat KerasRegressor dari model yang sudah dibuat</span>
<span class="n">neural_network</span> <span class="o">=</span> <span class="n">KerasRegressor</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">create_model</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Membuat model Bagging Regressor dengan estimator neural network</span>
<span class="n">bagging_model</span> <span class="o">=</span> <span class="n">BaggingRegressor</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">neural_network</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="c1"># Melatih model</span>
<span class="n">bagging_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Evaluasi model pada data uji</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Skor pada data uji: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Membuat prediksi menggunakan data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Mengembalikan hasil prediksi ke skala asli (dari skala normalisasi)</span>
<span class="n">y_pred_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y_test_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Plot hasil prediksi vs nilai sebenarnya</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_original</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Harga Minyak Sebenarnya&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_original</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediksi Ensemble Bagging&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prediksi Harga Minyak Menggunakan Ensemble Bagging dan Neural Network&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga Minyak&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># Memutar label x untuk keterbacaan</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Menyesuaikan layout agar tidak terpotong</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Skor pada data uji: 0.6555400608758065
</pre></div>
</div>
<img alt="../_images/29683c68e71a196da412fa21ea6a0161bc516f405099ddde538a7b7942f2bf38.png" src="../_images/29683c68e71a196da412fa21ea6a0161bc516f405099ddde538a7b7942f2bf38.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>

<span class="c1"># Membuat prediksi menggunakan data uji</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Hitung Mean Absolute Error (MAE)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Error (MAE): </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Hitung Mean Squared Error (MSE)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error (MSE): </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Menghitung RMSE</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Root Mean Squared Error (RMSE): </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Hitung R-squared (R)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R-squared (R): </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Hitung Mean Absolute Percentage Error (MAPE)</span>
<span class="c1"># mape = np.mean(np.abs((y_test - y_pred) / y_test)) * 100</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Percentage Error (MAPE): </span><span class="si">{</span><span class="n">mape</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Absolute Error (MAE): 0.013764557785090129
Mean Squared Error (MSE): 0.00033715571887870527
Root Mean Squared Error (RMSE): 0.01836180053477069
R-squared (R): 0.6555400608758065
Mean Absolute Percentage Error (MAPE): 0.024493333609521783%
</pre></div>
</div>
</div>
</div>
<p>##Grid Search</p>
<p>Skenario akan dilakukan dengan percobaan menggunakan skenario hyperparameter</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span>        <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">batch_sizes</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
<span class="n">random_states</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
<span class="n">n_estimators</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>Total percobaan = 16</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scikeras.wrappers</span> <span class="kn">import</span> <span class="n">KerasRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Input</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

<span class="c1"># Definisikan jumlah lag dinamis</span>
<span class="n">num_lags</span> <span class="o">=</span> <span class="mi">4</span>  

<span class="c1"># Membuat kolom lag secara dinamis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">df_normalized</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c1"># Menghapus baris yang memiliki nilai NaN akibat lag</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Mengatur fitur (X) dan target (y)</span>
<span class="n">lag_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Harga-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">lag_columns</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="p">[</span><span class="s1">&#39;Harga&#39;</span><span class="p">]</span>

<span class="c1"># Fungsi untuk membuat model neural network</span>
<span class="k">def</span> <span class="nf">create_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_lags</span><span class="p">,)))</span>  <span class="c1"># Menggunakan num_lags sebagai input</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Daftar parameter untuk percobaan</span>
<span class="n">epochs_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">batch_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
<span class="n">random_states</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
<span class="n">n_estimators_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="c1"># Menyimpan hasil</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Melakukan iterasi melalui semua kombinasi hyperparameter</span>
<span class="k">for</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="n">epochs_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">batch_size</span> <span class="ow">in</span> <span class="n">batch_sizes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">random_state</span> <span class="ow">in</span> <span class="n">random_states</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n_estimators</span> <span class="ow">in</span> <span class="n">n_estimators_list</span><span class="p">:</span>

                <span class="c1"># Membuat KerasRegressor dari model yang sudah dibuat</span>
                <span class="n">neural_network</span> <span class="o">=</span> <span class="n">KerasRegressor</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">create_model</span><span class="p">,</span>
                                                 <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
                                                 <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="c1"># Membuat model Bagging Regressor dengan estimator neural network</span>
                <span class="n">bagging_model</span> <span class="o">=</span> <span class="n">BaggingRegressor</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">neural_network</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

                <span class="c1"># Membagi data menjadi training dan testing (80% training, 20% testing)</span>
                <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># Melatih model</span>
                <span class="n">bagging_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

                <span class="c1"># Melakukan prediksi menggunakan data uji</span>
                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

                <span class="c1"># Menghitung metrik evaluasi</span>
                <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

                <span class="c1"># Menyimpan hasil</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;Epochs&#39;</span><span class="p">:</span> <span class="n">epochs</span><span class="p">,</span>
                    <span class="s1">&#39;Batch Size&#39;</span><span class="p">:</span> <span class="n">batch_size</span><span class="p">,</span>
                    <span class="s1">&#39;Random State&#39;</span><span class="p">:</span> <span class="n">random_state</span><span class="p">,</span>
                    <span class="s1">&#39;N Estimators&#39;</span><span class="p">:</span> <span class="n">n_estimators</span><span class="p">,</span>
                    <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
                    <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span>
                    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span>
                <span class="p">})</span>

                <span class="c1"># Menyimpan model terbaik</span>
                <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
                    <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
                    <span class="n">best_model</span> <span class="o">=</span> <span class="n">bagging_model</span>
                    <span class="n">best_params</span> <span class="o">=</span> <span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">random_state</span><span class="p">,</span> <span class="n">n_estimators</span><span class="p">)</span>

<span class="c1"># Membuat DataFrame dari hasil</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Menampilkan hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>

<span class="c1"># Menampilkan model terbaik dan parameter terbaik</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model terbaik dengan RMSE:&quot;</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameter model terbaik:&quot;</span><span class="p">,</span> <span class="n">best_params</span><span class="p">)</span>

<span class="c1"># Menggunakan model terbaik untuk memprediksi</span>
<span class="n">y_best_pred</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Plot hasil prediksi vs nilai sebenarnya untuk model terbaik</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Harga Sebenarnya&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_best_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediksi Ensemble Bagging&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prediksi Harga Menggunakan Ensemble Bagging dan Neural Network (Model Terbaik)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Epochs  Batch Size  Random State  N Estimators        R       MSE  \
0       20          32            24             5  0.698464  0.000304   
1       20          32            24            10  0.685795  0.000316   
2       20          32            42             5  0.636097  0.000366   
3       20          32            42            10  0.662861  0.000339   
4       20          42            24             5  0.689446  0.000313   
5       20          42            24            10  0.592514  0.000410   
6       20          42            42             5  0.599739  0.000403   
7       20          42            42            10  0.592580  0.000410   
8       50          32            24             5  0.694640  0.000307   
9       50          32            24            10  0.671136  0.000331   
10      50          32            42             5  0.660320  0.000342   
11      50          32            42            10  0.668899  0.000333   
12      50          42            24             5  0.698452  0.000304   
13      50          42            24            10  0.676634  0.000325   
14      50          42            42             5  0.652944  0.000349   
15      50          42            42            10  0.663247  0.000339   

        RMSE  
0   0.017422  
1   0.017784  
2   0.019139  
3   0.018421  
4   0.017680  
5   0.020252  
6   0.020072  
7   0.020251  
8   0.017532  
9   0.018194  
10  0.018491  
11  0.018256  
12  0.017422  
13  0.018041  
14  0.018690  
15  0.018411  
Model terbaik dengan RMSE: 0.017421671015900624
Parameter model terbaik: (20, 32, 24, 5)
</pre></div>
</div>
<img alt="../_images/64887c1cf467a0b98283d6b4c59f1c6eff59e8450aa3f6e2e6cb03044db590ed.png" src="../_images/64887c1cf467a0b98283d6b4c59f1c6eff59e8450aa3f6e2e6cb03044db590ed.png" />
</div>
</div>
<p>##Uji Coba</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Fungsi untuk memprediksi kurs berdasarkan input dari pengguna</span>
<span class="k">def</span> <span class="nf">predict_custom_data</span><span class="p">(</span><span class="n">input_data</span><span class="p">):</span>

    <span class="c1"># Reshape input to (1, 1) for scaling</span>
    <span class="n">input_data_reshaped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Normalize data input using scaler_features</span>
    <span class="n">input_data_normalized</span> <span class="o">=</span> <span class="n">scaler_features</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_data_reshaped</span><span class="p">)</span>

    <span class="c1"># Reshape the scaled data to match the model&#39;s input shape (1, num_lags)</span>
    <span class="n">input_data_normalized</span> <span class="o">=</span> <span class="n">input_data_normalized</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Prediksi dengan model Bagging Regressor</span>
    <span class="n">predicted_normalized</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_data_normalized</span><span class="p">)</span>

    <span class="c1"># Mengembalikan prediksi ke skala asli</span>
    <span class="n">predicted_original</span> <span class="o">=</span> <span class="n">scaler_target</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">predicted_normalized</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">predicted_original</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Meminta input dari pengguna</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Masukkan harga minyak dari minggu-minggu sebelumnya:&quot;</span><span class="p">)</span>
<span class="n">harga_1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Harga 1 hari sebelumnya : &quot;</span><span class="p">))</span>
<span class="n">harga_2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Harga 2 hari sebelumnya : &quot;</span><span class="p">))</span>
<span class="n">harga_3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Harga 3 hari sebelumnya : &quot;</span><span class="p">))</span>
<span class="n">harga_4</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Harga 4 hari sebelumnya : &quot;</span><span class="p">))</span>

<span class="c1"># Data input yang dimasukkan oleh pengguna</span>
<span class="n">user_input</span> <span class="o">=</span> <span class="p">[</span><span class="n">harga_1</span><span class="p">,</span> <span class="n">harga_2</span><span class="p">,</span> <span class="n">harga_3</span><span class="p">,</span> <span class="n">harga_4</span><span class="p">]</span>

<span class="c1"># Prediksi harga minyak untuk data yang dimasukkan</span>
<span class="n">predicted_value</span> <span class="o">=</span> <span class="n">predict_custom_data</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>

<span class="c1"># Menampilkan hasil prediksi</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi harga minyak untuk minggu selanjutnya adalah: </span><span class="si">{</span><span class="n">predicted_value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Masukkan harga minyak dari minggu-minggu sebelumnya:
Harga 1 hari sebelumnya : 15600
Harga 2 hari sebelumnya : 15550
Harga 3 hari sebelumnya : 15500
Harga 4 hari sebelumnya : 15550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/sklearn/base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/sklearn/base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prediksi harga minyak untuk minggu selanjutnya adalah: 15960.75
</pre></div>
</div>
</div>
</div>
<p>##Perbandingan Metode</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Mengambil dan menampilkan data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/PSD/Perbandingan_Metode/perbandingan_metode2.csv&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a211211a-5cef-47a2-bce4-1acbbea13e6d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>lag-4</th>
      <th>lag-5</th>
      <th>lag-6</th>
      <th>lag-7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>model-1 (JST)</td>
      <td>0.03%</td>
      <td>0.06%</td>
      <td>0.05%</td>
      <td>0.04%</td>
    </tr>
    <tr>
      <th>1</th>
      <td>model-2(SVM)</td>
      <td>1318012082465950.00%</td>
      <td>1247217424504390.00%</td>
      <td>1104240897551030.00%</td>
      <td>1167438802916020.00%</td>
    </tr>
    <tr>
      <th>2</th>
      <td>model-3(Regresi Random Forest)</td>
      <td>5.82%</td>
      <td>5.63%</td>
      <td>5.37%</td>
      <td>5.37%</td>
    </tr>
    <tr>
      <th>3</th>
      <td>model-4(Logistic Regresi)</td>
      <td>1195322103805420.00%</td>
      <td>1181844009382110.00%</td>
      <td>1161121599742140.00%</td>
      <td>1140179286661270.00%</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a211211a-5cef-47a2-bce4-1acbbea13e6d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a211211a-5cef-47a2-bce4-1acbbea13e6d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a211211a-5cef-47a2-bce4-1acbbea13e6d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ff775b80-a47f-4b91-8364-2c1b4362e481">
  <button class="colab-df-quickchart" onclick="quickchart('df-ff775b80-a47f-4b91-8364-2c1b4362e481')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ff775b80-a47f-4b91-8364-2c1b4362e481 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_28fe6b97-e8b0-4428-ab33-a760a5eb312b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_28fe6b97-e8b0-4428-ab33-a760a5eb312b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tugas_uts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Proyek Sains Data</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="simple visible nav section-nav flex-column">
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>